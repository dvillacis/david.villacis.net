<!DOCTYPE HTML>
<html dir="ltr" lang="en-US">
	<head>

	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Solving the ROF Denoising Model using Chambolle-Pock | David Villacis</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Solving the ROF Denoising Model using Chambolle-Pock" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Let us recall the variational model used for image denoising proposed by Rudin, Osher and Fatemi (ROF)" />
<meta property="og:description" content="Let us recall the variational model used for image denoising proposed by Rudin, Osher and Fatemi (ROF)" />
<link rel="canonical" href="http://david.villacis.net/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/" />
<meta property="og:url" content="http://david.villacis.net/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/" />
<meta property="og:site_name" content="David Villacis" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-12-14T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Solving the ROF Denoising Model using Chambolle-Pock" />
<script type="application/ld+json">
{"description":"Let us recall the variational model used for image denoising proposed by Rudin, Osher and Fatemi (ROF)","headline":"Solving the ROF Denoising Model using Chambolle-Pock","dateModified":"2018-12-14T00:00:00-05:00","datePublished":"2018-12-14T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://david.villacis.net/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/"},"url":"http://david.villacis.net/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

	<meta name="author" content="David Villacis" />
  <meta name="description" content=""

	<!-- Stylesheets
	============================================= -->
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,400italic,600,700|Raleway:300,400,500,600,700|Crete+Round:400italic" rel="stylesheet" type="text/css" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
	<link rel="stylesheet" href="/css/style.css" type="text/css" />
	<link rel="stylesheet" href="/css/swiper.css" type="text/css" />
	<link rel="stylesheet" href="/css/dark.css" type="text/css" />
	<link rel="stylesheet" href="/css/font-icons.css" type="text/css" />
	<link rel="stylesheet" href="/css/animate.css" type="text/css" />
	<link rel="stylesheet" href="/css/magnific-popup.css" type="text/css" />
	<link rel="stylesheet" href="/css/syntax.css" type="text/css" />

	<link rel="stylesheet" href="/css/responsive.css" type="text/css" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<!-- Document Title
	============================================= -->
	<title>Solving the ROF Denoising Model using Chambolle-Pock</title>

	<link type="application/atom+xml" rel="alternate" href="http://david.villacis.net/feed.xml" title="David Villacis" />
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68031487-2', 'auto');
  ga('send', 'pageview');

</script>

	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-7181720568368396",
    enable_page_level_ads: true
  });
</script>


	<script type="text/javascript" async
	  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
	</script>

</head>

	<body class="stretched" data-loader="6" data-animation-in="fadeIn">

		<!-- Wrapper -->
			<div id="wrapper" class="clearfix">

				<!-- Header
============================================= -->
<header id="header" class="sticky-style-2">

  <div class="container clearfix">

    <!-- Logo
    ============================================= -->
    <div id="logo" class="divcenter">
      <!-- <a href="/"><div class="divcenter">HOLA</div></a> -->
      <a href="/" class="standard-logo" data-dark-logo="/images/logo-dark.png"><img class="divcenter" src="/images/logo.png" alt="David Villacis"></a>
      <a href="/" class="retina-logo" data-dark-logo="/images/logo-dark.png"><img class="divcenter" src="/images/logo.png" alt="David Villacis"></a>
    </div><!-- #logo end -->

  </div>

  <div id="header-wrap">

    <!-- Primary Navigation
    ============================================= -->
    <nav id="primary-menu" class="style-2 center">

      <div class="container clearfix">

        <div id="primary-menu-trigger"><i class="icon-reorder"></i></div>

        <ul>
          
            <li><a href="/"><div>Home</div></a></li>
          
          
            <li><a href="/bio"><div>Bio</div></a></li>
          
          
            <li><a href="/research"><div>Research</div></a></li>
          
          
            <li><a href="/code"><div>Code</div></a></li>
          
          
            <li><a href="/teaching"><div>Teaching</div></a></li>
          
          
            <li class="current"><a href="/blog"><div>Blog</div></a></li>
          
          <!-- 
            <li><a href="/photo_blog"><div>Photo Blog</div></a></li>
           -->
          
            <li><a href="/contact"><div>Contact</div></a></li>
          
        </ul>

        <!-- Top Search
        ============================================= -->
        <div id="top-search">
          <a href="#" id="top-search-trigger"><i class="icon-search3"></i><i class="icon-line-cross"></i></a>
          <form>
            <input type="text" name="q" class="form-control super-search__input" id="js-super-search__input" value="" placeholder="Type &amp; Hit Enter..">
            <ul class="super-search__results" id="js-super-search__results"></ul>
          </form>
        </div><!-- #top-search end -->

      </div>

    </nav><!-- #primary-menu end -->

  </div>

</header><!-- #header end -->


				<!-- Content -->
        <section id="content">
	<div class="content-wrap">
    <div class="container clearfix">
			<div class="postcontent nobottommargin clearfix">
				<div class="single-post nobottommargin">
					<div class="entry clearfix">
						<div class="entry-title">
							<h2>Solving the ROF Denoising Model using Chambolle-Pock</h2>
						</div>
						<div class="entry-meta clearfix">
							<li><i class="icon-calendar3"></i>14 December 2018</li>
						</div>
						<div class="entry-image bottommargin">
							<a href=""><img src="https://storage.googleapis.com/pagina-personal.appspot.com/img_blog/chambolle_pock_denoising/cp_playing_cards.png" alt="Solving the ROF Denoising Model using Chambolle-Pock"></a>
						</div>
						<div class="entry-content">
							<p>Let us recall the variational model used for image denoising proposed by Rudin, Osher and Fatemi (ROF)</p>

\[\max_x \frac{1}{2}\|x-f\|^2+\alpha\|\mathbb{K}x\|_{2,1},\]

<p>where \(f\in\mathbb{R}^n\) is the noise contaminated image, \(\mathbb{K}\in\mathbb{R}^{n\times m}\) the discrete gradient operator and \(\|\cdot\|_{2,1}\) is the anisotropic Total Variation (TV) seminorm.</p>

<p>This model as presented is very challenging to solve, mainly due to the nonsmoothnes of the total variation seminorm. In <a href="https://david.villacis.net/blog/2017/02/01/rof-denoising-dual-formulation/">this previous blog post</a> we used a fenchel dual formulation to solve it by using a projected gradient descent algorithm as described <a href="https://david.villacis.net/blog/2017/04/06/solving-dual-rof-using-projected-gradient-descent/">here</a>. Now, our goal is to improve this results by relying in a <em>Saddle Point Formulation</em>. Indeed, such formulation involves primal and dual variables, rougly speaking it removes the complexity nonsmooth term (TV) by relying on its dual formulation while leaving the smooth part untouched.</p>

<p>Particularly, the Rudin-Osher-Fatemi (ROF) Model can be solved using a saddle point formulation which can be written as:</p>

\[\min_x \max_y g(x) + \langle \mathbb{K} x,y\rangle - f^*(y)\]

\[\min_x \max_y \frac{1}{2}\|x-f\|_2^2 + \langle \mathbb{K} x,y\rangle - \delta_{B_\alpha}(y)\]

<p>This separation allows us to use a primal-dual numerical approach to solve this problem. On order to do so, this method relies on the calculation of the proximal operators of the previously presented functions.</p>

<h2 id="the-proximal-operator">The Proximal Operator</h2>
<p>The proximal operator is a key piece when dealing with non-differentiable functions. It consists on modifying the original function with a Moreau-Yosida regularization:</p>

\[\hat{f}(x) = f(x)+\frac{1}{2\tau}\|\bar{x}-x\|_2^2\]

<p>This regularization makes the original function to be strictly convex, which implies that it has a unique minimizer (this is not the case for convex functions). Indeed, this minimizer is known as the <em>proximal</em> of the function \(f\):</p>

\[prox_{\tau\partial f}(x) = arg\min_{\bar{x}} f(x) + \frac{1}{2\tau}\|\bar{x}-x\|_2^2\]

<p>Eventhough this equation shows a formula for calculating this proximal operator, we have to solve an optimization problem to find it. Therefore, this formulation is useful when the solution of this problem has a closed form that is easy to implement and can be done offline.</p>

<h2 id="chambolle-pock-method">Chambolle-Pock Method</h2>
<p>This is a first order method, it means that it only uses information for the first derivative of the objective function. Both proximal operators for the smooth and nonsmooth parts are easy to calculate and implement.</p>

<p>This method defines the following iterative scheme:</p>

\[x_{k+1} = prox_{\tau \partial g}(x_k-\tau\mathbb{K}^\top y_k)\]

\[\bar{x}_{k+1} = 2x_{k+1} - x_k\]

\[y_{k+1} = prox_{\sigma \partial f^*}(y_k+\sigma \mathbb{K}\bar{x}_{k+1})\]

<p>Therefore, for our specific case we need to calculate both the proximal of \(g\) and \(f^*\):</p>

<h4 id="proximal-gx--frac12x-f_22">Proximal \(g(x) = \frac{1}{2}\|x-f\|_2^2\)</h4>
<p>In this calculation we will use as described in the definition, a Moreau-Yosida regularization of \(g\):</p>

\[prox_{\tau\partial g}(x) = arg\min_{\bar x} \frac{1}{2}\|\bar{x}-f\|_2^2 + \frac{1}{2\tau}\|\bar{x}-x\|_2^2\]

<p>The necessary and sufficient condition for the optimal value \(\bar{x}\) is:</p>

\[(\bar{x}-f)+\frac{1}{\tau}(\bar{x}-x) = 0\]

\[x = \tau(\bar{x}-f) + \bar{x}\]

\[x = (\tau+1)\bar{x}-\tau f\]

\[\bar{x} = \frac{x+\tau f}{\tau+1}\]

<p>Which yields:</p>

\[prox_{\tau\partial g}(x) = \frac{x_k + \tau(f-\mathbb{K}^\top y_k)}{\tau +1}\]

<h4 id="proximal-fy--delta_b_alphay">Proximal \(f^*(y) = \delta_{B_\alpha}(y)\)</h4>

\[prox_{\sigma\partial f^*}(y) = arg\min_{\bar{y}} \delta_{B_\alpha}(\bar{y}) + \frac{1}{2\sigma}\|\bar{y}-y\|_2^2\]

<p>As can be seen this leads to a new optimization problem, this problem can be solved by analyzing the first order optimality condition of this problem:</p>

\[0 \in \partial \delta_{B_\alpha}(\bar{y}) + (\bar{y}-y)\]

<p>Where \(\partial \delta_{B_\alpha}(y)\) is the convex subdifferendial of the indicator function of the \(\lambda\)-ball. Which can be characterized by the piwelwise orthogonal projection onto an \(l_2\) ball of radius \(\alpha\), and can be easily computed using this formula</p>

\[\tilde{y}_j = \frac{y_j}{\max(1,\alpha^{-1}\|y\|)},\;\forall j=1,\dots,n\]

<h3 id="stopping-criteria">Stopping Criteria</h3>
<p>As usual with these primal-dual methos, it is customary to use a measure for convergence. In this case it corresponds to the primal-dual gap</p>

\[PD(x,y) = f(\mathbb{K}x)+g(x)+f^*(y)+g^*(-\mathbb{K}^*y)\]

<p>where \(g^*\) is the classical fenchel conjugate of \(g\) which we previously reviewed.</p>

<h2 id="matlab-code">MATLAB Code</h2>
<p>A working implementation can be found in our newly created repository <a href="https://github.com/dvillacis/bilevel_toolbox">Bilevel Toolbox</a>. The main part of the method has the following form</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="p">[</span><span class="n">sol</span><span class="p">,</span><span class="n">gap</span><span class="p">]</span> <span class="o">=</span> <span class="n">solve_rof_cp_single_gaussian</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">param</span><span class="p">)</span>

  <span class="c1">% Start the counter</span>
  <span class="n">t1</span> <span class="o">=</span> <span class="nb">tic</span><span class="p">;</span>

  <span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
  <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(:);</span>

  <span class="n">nabla</span> <span class="o">=</span> <span class="n">gradient_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>

  <span class="n">p</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">sol</span> <span class="o">=</span> <span class="n">f</span><span class="p">;</span>
  <span class="n">sol_</span> <span class="o">=</span> <span class="n">sol</span><span class="p">;</span>
  <span class="n">L</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
  <span class="n">tau</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>
  <span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span><span class="p">/</span><span class="n">tau</span><span class="p">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
  <span class="n">gap</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="c1">% Auxiliary terms</span>
  <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">/(</span><span class="mi">1</span><span class="o">+</span><span class="n">tau</span><span class="p">);</span>
  <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">/</span><span class="n">param</span><span class="o">.</span><span class="nb">alpha</span><span class="p">;</span>

  <span class="k">for</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">param</span><span class="o">.</span><span class="n">maxiter</span>

    <span class="c1">% Dual step calculation</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">sigma</span><span class="o">*</span><span class="n">nabla</span><span class="o">*</span><span class="n">sol_</span><span class="p">;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="nb">bsxfun</span><span class="p">(</span><span class="o">@</span><span class="nb">rdivide</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">*</span><span class="n">rssq</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">))),</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

    <span class="c1">%Primal Step calculation</span>
    <span class="n">sol_</span> <span class="o">=</span> <span class="n">sol</span><span class="p">;</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">sol</span> <span class="o">-</span> <span class="n">tau</span><span class="o">*</span><span class="n">nabla</span><span class="o">'*</span><span class="n">p</span><span class="p">;</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">sol</span><span class="o">+</span><span class="n">tau</span><span class="o">*</span><span class="n">f</span><span class="p">);</span>

    <span class="c1">% Overrelaxation step</span>
    <span class="n">sol_</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">sol</span> <span class="o">-</span><span class="n">sol_</span><span class="p">;</span>

    <span class="n">ga</span> <span class="o">=</span> <span class="n">compute_rof_pd_gap</span><span class="p">(</span><span class="n">nabla</span><span class="p">,</span> <span class="n">sol</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">param</span><span class="o">.</span><span class="nb">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">);</span>

    <span class="n">gap</span> <span class="o">=</span> <span class="p">[</span><span class="n">gap</span><span class="p">,</span> <span class="n">ga</span><span class="p">];</span>

    <span class="k">if</span> <span class="nb">mod</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">param</span><span class="o">.</span><span class="n">check</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">param</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span>
      <span class="nb">fprintf</span><span class="p">(</span><span class="s1">'rof_cp: iter = %4d, gap = %f\n'</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ga</span><span class="p">);</span>
    <span class="k">end</span>

    <span class="k">if</span> <span class="n">ga</span> <span class="o">&lt;</span> <span class="n">param</span><span class="o">.</span><span class="n">tol</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">end</span>

  <span class="k">end</span>
  <span class="n">sol</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>

  <span class="c1">% Print summary</span>
  <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">verbose</span><span class="o">&gt;</span><span class="mi">0</span>
    <span class="nb">fprintf</span><span class="p">([</span><span class="s1">'\n '</span><span class="p">,</span><span class="s1">'ROF_CHAMBOLLE_POCK'</span><span class="p">,</span><span class="s1">':\n'</span><span class="p">]);</span>
    <span class="nb">fprintf</span><span class="p">(</span><span class="s1">' %i iterations\n'</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span>
    <span class="nb">fprintf</span><span class="p">(</span><span class="s1">' Primal-Dual Gap: %f \n'</span><span class="p">,</span> <span class="n">gap</span><span class="p">(</span><span class="k">end</span><span class="p">));</span>
    <span class="nb">fprintf</span><span class="p">(</span><span class="s1">' Execution Time: %f \n\n'</span><span class="p">,</span> <span class="nb">toc</span><span class="p">(</span><span class="n">t1</span><span class="p">));</span>
  <span class="k">end</span>

<span class="k">end</span>
</code></pre></div></div>
<p>As for the primal dual gap it can be implemented by calculating the primal and dual values as follows</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="p">[</span><span class="n">gap</span><span class="p">,</span> <span class="n">primal</span><span class="p">,</span> <span class="n">dual</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_rof_pd_gap</span><span class="p">(</span><span class="n">nabla</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">lambda</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

  <span class="n">div_p</span> <span class="o">=</span> <span class="n">nabla</span><span class="o">'*</span><span class="n">p</span><span class="p">;</span>
  <span class="n">nabla_u</span> <span class="o">=</span> <span class="n">nabla</span><span class="o">*</span><span class="n">u</span><span class="p">;</span>

  <span class="n">nu</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">reshape</span><span class="p">(</span><span class="n">nabla_u</span><span class="p">,</span> <span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">));</span>

  <span class="n">primal</span> <span class="o">=</span> <span class="n">lambda</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">norm</span><span class="p">(</span><span class="n">u</span><span class="o">-</span><span class="n">f</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>
  <span class="n">dual</span> <span class="o">=</span> <span class="o">-</span><span class="nb">norm</span><span class="p">(</span><span class="n">div_p</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">f</span><span class="o">'*</span><span class="n">div_p</span><span class="p">;</span>

  <span class="n">gap</span> <span class="o">=</span> <span class="n">primal</span><span class="o">-</span><span class="n">dual</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></div>

<h2 id="numerical-experiment">Numerical Experiment</h2>
<p>We can see that this method converges much faster than the dual version presented in a previous post. Furthermore, as we can calculate the projection operator pixelwise, it is possible to take advantage of parallel computing, in particular GPU computing to make this operation very efficient. A recent effort in implementing this can be read in the following <a href="https://lajc.epn.edu.ec/index.php/LAJC/article/view/133">paper</a>.</p>

<p>We can see the algorithm indeed denoises the image as expected</p>

<p><img src="https://storage.googleapis.com/pagina-personal.appspot.com/img_blog/chambolle_pock_denoising/cp_playing_cards.png" alt="cp_playing_cards" /></p>

<p>And we can see a decrease in the primal dual gap, confirming it is indeed converging to a solution.</p>

<p><img src="https://storage.googleapis.com/pagina-personal.appspot.com/img_blog/chambolle_pock_denoising/cp_gap.png" alt="cp_gap" /></p>

						</div>
						<!-- Tag Cloud
						============================================= -->
						<h5>Tag Cloud</h5>
						<div class="tagcloud clearfix bottommargin">
							
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">backward</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">chambolle</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">fatemi</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">fenchel</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">matlab</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">optimization</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">osher</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">pock</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">point</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">rof</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">rudin</a>
							
							<a href="/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/">saddle</a>
							
						</div><!-- .tagcloud end -->

						<div class="clear"></div>

						<!-- Post Single - Share
						============================================= -->
						<div class="si-share noborder clearfix">
							<span>Share this Post:</span>
							<div>
								<a href="https://facebook.com/sharer.php?u=http://david.villacis.net/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/" class="social-icon si-borderless si-facebook" target="_blank">
									<i class="icon-facebook"></i>
									<i class="icon-facebook"></i>
								</a>
								<a href="https://twitter.com/intent/tweet?text=Solving the ROF Denoising Model using Chambolle-Pock&url=http://david.villacis.net/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/&via=&related=" class="social-icon si-borderless si-twitter" target="_blank">
									<i class="icon-twitter"></i>
									<i class="icon-twitter"></i>
								</a>
								<a href="https://plus.google.com/share?url=http://david.villacis.net/blog/2018/12/14/primal-dual-methods-for-ROF-image-denoising/" class="social-icon si-borderless si-gplus" target="_blank">
									<i class="icon-gplus"></i>
									<i class="icon-gplus"></i>
								</a>
								<a href="#" class="social-icon si-borderless si-rss">
									<i class="icon-rss"></i>
									<i class="icon-rss"></i>
								</a>
								<a href="#" class="social-icon si-borderless si-email3">
									<i class="icon-email3"></i>
									<i class="icon-email3"></i>
								</a>
							</div>
						</div><!-- Post Single - Share End -->
					</div><!-- Entry end -->

					<!-- Post Navigation
					============================================= -->
					<div class="post-navigation clearfix">
						
						<div class="nobottommargin">
							<a href="/blog/2017/04/06/solving-dual-rof-using-projected-gradient-descent/">&lArr; Solving the Dual ROF Denoising Model using Projected Gradient Descent</a>
						</div>
						
						
					</div><!-- .post-navigation end -->

					<div class="line"></div>

					<h4>Related Posts:</h4>

					<div class="related-posts clearfix">
						<div class="col_half nobottommargin">
							
							<div class="mpost clearfix">
								<div class="entry-image">
									<a href="/blog/2017/04/06/solving-dual-rof-using-projected-gradient-descent/"><img src="https://storage.googleapis.com/pagina-personal.appspot.com/img_blog/dual_rof_denoising/gradient_descent_dual_rof.png" alt="Solving the Dual ROF Denoising Model using Projected Gradient Descent"></a>
								</div>
								<div class="entry-c">
									<div class="entry-title">
										<h4><a href="/blog/2017/04/06/solving-dual-rof-using-projected-gradient-descent/">Solving the Dual ROF Denoising Model using Projected Gradient Descent</a></h4>
									</div>
									<ul class="entry-meta clearfix">
										<li><i class="icon-calendar3"></i> 06 Apr 2017</li>
										<li><a href="/blog/2017/04/06/solving-dual-rof-using-projected-gradient-descent/"><i class="icon-comments"></i> 12</a></li>
									</ul>
									<div class="entry-content">We will solve the dual ROF model using a projected gradient descent algorithm using python, numpy and scipy</div>
								</div>
							</div>
							
							<div class="mpost clearfix">
								<div class="entry-image">
									<a href="/blog/2017/02/01/rof-denoising-dual-formulation/"><img src="https://storage.googleapis.com/pagina-personal.appspot.com/img_blog/dual_rof_denoising/dual_rof_denoise.png" alt="Dual ROF Image Denoising Model Formulation"></a>
								</div>
								<div class="entry-c">
									<div class="entry-title">
										<h4><a href="/blog/2017/02/01/rof-denoising-dual-formulation/">Dual ROF Image Denoising Model Formulation</a></h4>
									</div>
									<ul class="entry-meta clearfix">
										<li><i class="icon-calendar3"></i> 01 Feb 2017</li>
										<li><a href="/blog/2017/02/01/rof-denoising-dual-formulation/"><i class="icon-comments"></i> 12</a></li>
									</ul>
									<div class="entry-content">We will propose a dual model formulation for the Rudin Osher Fatemi denoising model</div>
								</div>
							</div>
							
					  </div>

					<!-- <div class="clearfix" id="comments">
						<h3>Comments</h3>
						<div id="disqus_thread"></div>
						<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = "http://david.villacis.net";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ""; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//image-processing-blog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



</div>

					</div> -->
				</div>
			</div>
		</div>



		<!-- .sidebar -->
		<div class="sidebar nobottommargin col_last clearfix">
			<div class="sidebar-widgets-wrap">
				<!-- Twitter Widget -->
				<div class="widget widget-twitter-feed clearfix">
					<h4>Twitter Feed</h4>
					<ul class="iconlist twitter-feed">
						<div class='jekyll-twitter-plugin'><a class="twitter-timeline" data-width="500" data-tweet-limit="3" href="https://twitter.com/davillacis?ref_src=twsrc%5Etfw">Tweets by davillacis</a>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
						<li></li>
					</ul>
					<a href="#" class="btn btn-default btn-sm fright">Follow me on Twitter</a>
				</div>

				<!-- Historic Widget -->
				<div class="widget clearfix">

					<div class="tabs nobottommargin clearfix" id="sidebar-tabs">

						<ul class="tab-nav clearfix">
							<li><a href="#tabs-1">Popular</a></li>
							<li><a href="#tabs-2">Recent</a></li>
							<li><a href="#tabs-3"><i class="icon-comments-alt norightmargin"></i></a></li>
						</ul>

						<div class="tab-container">

							<div class="tab-content clearfix" id="tabs-1">
								<div id="popular-post-list-sidebar">
									
								</div>
							</div>
							<div class="tab-content clearfix" id="tabs-2">
								<div id="recent-post-list-sidebar">
									
									<div class="spost clearfix">
										<div class="entry-image">
											<a href="#" class="nobg"><img class="img-circle" src="https://storage.googleapis.com/pagina-personal.appspot.com/img_blog/chambolle_pock_denoising/cp_playing_cards.png" alt="Solving the ROF Denoising Model using Chambolle-Pock"></a>
										</div>
										<div class="entry-c">
											<div class="entry-title">
												<h4><a href="#">Solving the ROF Denoising Model using Chambolle-Pock</a></h4>
											</div>
											<ul class="entry-meta">
												<li>14 Dec 2018</li>
											</ul>
										</div>
									</div>
									
									<div class="spost clearfix">
										<div class="entry-image">
											<a href="#" class="nobg"><img class="img-circle" src="https://storage.googleapis.com/pagina-personal.appspot.com/img_blog/dual_rof_denoising/gradient_descent_dual_rof.png" alt="Solving the Dual ROF Denoising Model using Projected Gradient Descent"></a>
										</div>
										<div class="entry-c">
											<div class="entry-title">
												<h4><a href="#">Solving the Dual ROF Denoising Model using Projected Gradient Descent</a></h4>
											</div>
											<ul class="entry-meta">
												<li>06 Apr 2017</li>
											</ul>
										</div>
									</div>
									
									<div class="spost clearfix">
										<div class="entry-image">
											<a href="#" class="nobg"><img class="img-circle" src="https://storage.googleapis.com/pagina-personal.appspot.com/img_blog/dual_rof_denoising/dual_rof_denoise.png" alt="Dual ROF Image Denoising Model Formulation"></a>
										</div>
										<div class="entry-c">
											<div class="entry-title">
												<h4><a href="#">Dual ROF Image Denoising Model Formulation</a></h4>
											</div>
											<ul class="entry-meta">
												<li>01 Feb 2017</li>
											</ul>
										</div>
									</div>
									
								</div>
							</div>
							<div class="tab-content clearfix" id="tabs-3">
								<div id="recent-post-list-sidebar">

									<div class="spost clearfix">
										<div class="entry-image">
											<a href="#" class="nobg"><img class="img-circle" src="/images/icons/avatar.jpg" alt=""></a>
										</div>
										<div class="entry-c">
											<strong>John Doe:</strong> Veritatis recusandae sunt repellat distinctio...
										</div>
									</div>

									<div class="spost clearfix">
										<div class="entry-image">
											<a href="#" class="nobg"><img class="img-circle" src="/images/icons/avatar.jpg" alt=""></a>
										</div>
										<div class="entry-c">
											<strong>Mary Jane:</strong> Possimus libero, earum officia architecto maiores....
										</div>
									</div>

									<div class="spost clearfix">
										<div class="entry-image">
											<a href="#" class="nobg"><img class="img-circle" src="/images/icons/avatar.jpg" alt=""></a>
										</div>
										<div class="entry-c">
											<strong>Site Admin:</strong> Deleniti magni labore laboriosam odio...
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- Portfolio Widget -->
				<div class="widget clearfix">

					<h4>Latest Projects</h4>
					<div id="oc-portfolio-sidebar" class="owl-carousel carousel-widget" data-items="1" data-margin="10" data-loop="true" data-nav="false" data-autoplay="5000">
						
						
						<div class="oc-item">
							<div class="iportfolio">
								<div class="portfolio-image">
									<a href="#">
										<img src="https://www.mak.com/images/stories/mak/2014/VRF-Capabilities/vrf_capabilities_bomb2d.png" alt="CEOTAS Tactical Training System">
									</a>
								</div>
								<div class="portfolio-desc center nobottompadding">
									<h3><a href="/research/projects/">CEOTAS Tactical Training System</a></h3>
									<!-- <span><a href="#">Graphics</a>, <a href="#">UI Elements</a></span> -->
								</div>
							</div>
						</div>
						
						<div class="oc-item">
							<div class="iportfolio">
								<div class="portfolio-image">
									<a href="#">
										<img src="https://www.epn.edu.ec/wp-content/uploads/2020/04/slavavidas.jpg" alt="Salvavidas">
									</a>
								</div>
								<div class="portfolio-desc center nobottompadding">
									<h3><a href="/research/projects/">Salvavidas</a></h3>
									<!-- <span><a href="#">Graphics</a>, <a href="#">UI Elements</a></span> -->
								</div>
							</div>
						</div>
						
					</div>
				</div>
			</div>
		</div>


</section>


				<!-- Footer
============================================= -->
<footer id="footer" class="dark">

	<!-- Copyrights
	============================================= -->
	<div id="copyrights">

		<div class="container clearfix">

			<div class="col_half">
				<img src="/images/logo_small2.png" alt="Footer Logo" class="footer-logo">

				Copyrights &copy; 2017 All Rights Reserved by Guaytambosoft Inc.

			</div>

			<div class="col_half col_last tright">
				<div class="copyrights-menu copyright-links fright clearfix">
					<a href="/">Home</a>/<a href="/bio">Bio</a>/<a href="/research">Research</a>/<a href="/code">Code</a>/<a href="/teaching">Teaching</a>/<a href="/blog">Blog</a>/<a href="/contact">Contact</a>
				</div>
				<div class="fright clearfix">
					<a href="https://www.facebook.com/dvillacisproano" class="social-icon si-small si-borderless nobottommargin si-facebook">
						<i class="icon-facebook"></i>
						<i class="icon-facebook"></i>
					</a>

					<a href="https://twitter.com/davillacis" class="social-icon si-small si-borderless nobottommargin si-twitter">
						<i class="icon-twitter"></i>
						<i class="icon-twitter"></i>
					</a>

					<a href="https://plus.google.com/101804704377950549504" class="social-icon si-small si-borderless nobottommargin si-gplus">
						<i class="icon-gplus"></i>
						<i class="icon-gplus"></i>
					</a>

					<a href="https://www.instagram.com/davillacis" class="social-icon si-small si-borderless nobottommargin si-instagram">
						<i class="icon-instagram"></i>
						<i class="icon-instagram"></i>
					</a>

					<a href="https://github.com/dvillacis" class="social-icon si-small si-borderless nobottommargin si-github">
						<i class="icon-github"></i>
						<i class="icon-github"></i>
					</a>

					<a href="https://www.linkedin.com/in/davidvillacis" class="social-icon si-small si-borderless nobottommargin si-linkedin">
						<i class="icon-linkedin"></i>
						<i class="icon-linkedin"></i>
					</a>
				</div>
			</div>

		</div>

	</div><!-- #copyrights end -->

</footer><!-- #footer end -->


			</div>

		<!-- Go To Top
			============================================= -->
			<div id="gotoTop" class="icon-angle-up"></div>


		<!-- External JavaScripts
============================================= -->
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/js/plugins.js"></script>
<script type="text/javascript" src="/js/typed.min.js"></script>

<!-- Google Maps
============================================= -->
<script type="text/javascript" src="https://maps.google.com/maps/api/js?key=AIzaSyACeeu1jEL45xNnt71iAsWqhZrUUg2lBxs"></script>
<script type="text/javascript" src="/js/jquery.gmap.js"></script>

<!-- Search
============================================= -->
<script type="text/javascript" src="/js/super-search.js"></script>

<!-- Disqus
============================================= -->
<script id="dsq-count-scr" src="//image-processing-blog.disqus.com/count.js" async></script>

<!-- Footer Scripts
============================================= -->
<script type="text/javascript" src="/js/functions.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

	</body>
</html>
